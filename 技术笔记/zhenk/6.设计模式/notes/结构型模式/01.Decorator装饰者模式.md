> 亦称： 装饰者模式、装饰器模式、Wrapper、Decorator

## 意图
**装饰模式**是一种结构型设计模式，是一种语义上的模式， 允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为。<font color = red>用聚合代替继承</font>

## 问题
继承带来的问题使之装饰者和被装饰者之间耦合度太高
![[继承带来的问题--装饰者模式聚合.png]]

## 进一步问题
聚合被装饰者的话也会导致装饰者和被装饰者也耦合在一起了，需要把聚合到装饰者的对象改成都实现的那个接口
![[被装饰者聚合到装饰者带来的问题.png]]

## 解决
* 把聚合到装饰者的对象换成被装饰者实现的那个接口（装饰者模式），这时候RectDecorator和TailDecorator以及GoDecorator都可以之间聚合嵌套在一起（因为都聚合了GameObject接口）。装饰者不能专属于某个被装饰者而是需要通过被装饰者实现的那个接口聚合到装饰者中去。
* bullet子弹是可以和RectDecorator聚合在一起也可以和TailDecorator聚合在一起。
* RectDecorator和TailDecorator之间也可以聚合嵌套在一起（new TailDecorator(new RectDecorator(new bullet()))）
![[装饰者模式UML.png]]
## 结构
![[装饰者模式结构图.png]]


## 应用
### Java的I/O库
在Java的I/O库中，`OutputStream`、`OutputStreamWriter`和`BufferedWriter`正是装饰者模式的应用。
1. **OutputStream：**
    - **角色：** 原始组件（Component）。
    - **描述：** `OutputStream`是Java I/O库中输出流的抽象基类，定义了写入字节流的基本方法。它是被装饰的基础组件。
2. **OutputStreamWriter：**
    - **角色：** 具体装饰者（Concrete Decorator）。
    - **描述：** `OutputStreamWriter`是`Writer`的子类，实现了`OutputStream`的装饰者。它将字符流转换为字节流。通过使用`OutputStream`的实例作为构造函数参数，它在字符流之上添加了字节流的功能。
3. **BufferedWriter：**
    - **角色：** 具体装饰者（Concrete Decorator）。
    - **描述：** `BufferedWriter`是`Writer`的子类，也是`OutputStreamWriter`的装饰者。它添加了缓冲区的功能，提高了写入效率。

在这个例子中，`OutputStreamWriter`和`BufferedWriter`都是装饰者，它们扩展了原始的`OutputStream`功能。这种嵌套的装饰允许你动态地组合对象，以便在运行时根据需要添加或删除行为。

以下是一个简化的示例代码：
```java
// Component: OutputStream
OutputStream outputStream = new FileOutputStream("output.txt");

// Concrete Decorator: OutputStreamWriter
OutputStreamWriter writer = new OutputStreamWriter(outputStream, StandardCharsets.UTF_8);

// Concrete Decorator: BufferedWriter
BufferedWriter bufferedWriter = new BufferedWriter(writer);

// 使用装饰后的对象进行写入操作
bufferedWriter.write("Hello, Decorator Pattern!");

// 关闭流
bufferedWriter.close();
```

在这个例子中，`OutputStream`是基础组件，`OutputStreamWriter`和`BufferedWriter`是具体装饰者，通过层层嵌套实现了功能的叠加。


## 优缺点
### 优点
-  你无需创建新子类即可扩展对象的行为。
-  你可以在运行时添加或删除对象的功能。
-  你可以用多个装饰封装对象来组合几种行为。
-  _单一职责原则_。 你可以将实现了许多不同行为的一个大类拆分为多个较小的类。

### 缺点
-  在封装器栈中删除特定封装器比较困难。
-  实现行为不受装饰栈顺序影响的装饰比较困难。
-  各层的初始化配置代码看上去可能会很糟糕。

## 和桥接模式区别
* 语义上之间不同，在语法上很类似。
* 桥接模式是两个分支的独立发展，而装饰者模式强调的是我对某对象的装饰（语义）
